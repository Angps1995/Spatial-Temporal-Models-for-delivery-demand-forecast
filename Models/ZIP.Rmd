---
title: "Zero-Inflated Model"
output: html_notebook
---

```{r}
library(tscount)
library(urca)
library(pscl)
```

```{r}
#Load dataset
full_df <- read.csv("/home/angps/Documents/Thesis/Data/df_>=1cts.csv")
df_atleast_50cts <- read.csv("/home/angps/Documents/Thesis/Data/data_>=50cts.csv")
train <- df_atleast_50cts
```

```{r}
#t <- train[1,]
#ts <- as.numeric(t[-1])
#lag1 <- as.numeric(t[-length(t)])
#df <- data.frame(ts, lag1)

#m <- zeroinfl(ts ~ lag1, data = df, dist = 'poisson')


train <- df_atleast_50cts[,1:198]
test <- df_atleast_50cts[,199:204]
#train<- full_df[,1:198]
#test <- full_df[,199:204]
errors <- 0
for (i in c(1:dim(train)[1])) {
    t <- train[i,]    
    ts <- as.numeric(t[-1])
    lag1 <- as.numeric(t[-length(t)])
    df <- data.frame(ts, lag1)
    #fit <- zeroinfl(ts ~ lag1, data = df, dist = 'poisson')
    fit <- glm(ts ~ lag1, family="poisson")
    #pred <- predict(fit, newdata=as.data.frame(t))
    pred <- predict(fit,newdata = t,type='response')
    #error <- sum(((as.numeric(test[i,]) - pred$pred)) ^ 2)
    error <- sum(((as.numeric(test[i,]) - pred[1:6])) ^ 2)
    errors <- errors + error
}
print(paste0(" MSFE: ", errors/6))

```