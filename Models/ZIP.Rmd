---
title: "Zero-Inflated Model"
output: html_notebook
---

```{r}
library(tscount)
library(urca)
library(pscl)
```

```{r}
#Load dataset
full_df <- read.csv("/home/angps/Documents/Thesis/Data/df_>=1cts.csv")
df_atleast_50cts <- read.csv("/home/angps/Documents/Thesis/Data/data_>=50cts.csv")
train <- df_atleast_50cts
```

```{r}
#t <- train[1,]
#ts <- as.numeric(t[-1])
#lag1 <- as.numeric(t[-length(t)])
#df <- data.frame(ts, lag1)

#m <- zeroinfl(ts ~ lag1, data = df, dist = 'poisson')


train <- df_atleast_50cts[,1:162]
test <- df_atleast_50cts[,163:204]
for (i in c(1:dim(train)[1])) {
    t <- train[i,]    
    ts <- as.numeric(t[-1])
    lag1 <- as.numeric(t[-length(t)])
    df <- data.frame(ts, lag1)
    fit <- zeroinfl(ts ~ lag1, data = df, dist = 'poisson')
    pred <- predict(fit, as.data.frame(t))
    error <- sum(((as.numeric(test[i,]) - pred$pred)) ^ 2)
    errors <- errors + error
}
print(paste0("Max Past ObsL ", obs ," Past Mean: ", m, " MSFE: ", errors/42))

```